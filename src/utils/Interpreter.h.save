#ifndef INTERPRETER_H_
#define INTERPRETER_H_

#include <memory>
#include <vector>

#include "../lang/SyntaxVisitor.h"
#include "../lang/Var.h"

namespace std {

class Program;

typedef vector<shared_ptr<Value>> Stack;

class Interpreter: public SyntaxVisitor, public enable_shared_from_this<Interpreter> {
public:
	Interpreter();
	virtual ~Interpreter();

	virtual void accept(shared_ptr<Type>);
	virtual void accept(shared_ptr<Value>);
	virtual void accept(shared_ptr<Func>);
	virtual void accept(shared_ptr<Program>);

	virtual void accept(shared_ptr<BlockStmt>);
	virtual void accept(shared_ptr<InitStmt>);
	virtual void accept(shared_ptr<AssignStmt>);
	virtual void accept(shared_ptr<IfStmt>);
	virtual void accept(shared_ptr<WhileStmt>);
	virtual void accept(shared_ptr<ForStmt>);
	virtual void accept(shared_ptr<PrintStmt>);
	virtual void accept(shared_ptr<EvalStmt>);
	virtual void accept(shared_ptr<ReturnStmt>);
	virtual void accept(shared_ptr<BreakStmt>);
	virtual void accept(shared_ptr<SwitchStmt>);

	virtual void accept(shared_ptr<ConstExpr>);
	virtual void accept(shared_ptr<IsTypeExpr>);
	virtual void accept(shared_ptr<VariableExpr>);
	virtual void accept(shared_ptr<FuncCallExpr>);

private:
	Stack stack;
	vector<VarMap> vars;
	vector<shared_ptr<Value>> eval;

	bool isReturn;
	bool isBreak;

};

} /* namespace std */

#endif /* INTERPRETER_H_ */
